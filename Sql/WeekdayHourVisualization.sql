select DATEADD(dd, 0, DATEDIFF(dd, 0, [Time])) as Date ,CAST(DATEPART(dw, Time) AS INT) as Week,DATENAME(dw, Time), CAST(DATEPART(hh, Time) AS INT) as Hour, concat(DATENAME(dw, Time),DATEPART(hh, Time)) as Weekday_Hour , SUM(CAST(Monitor_Alarm AS INT)) as Amount ,DENSE_RANK() OVER(ORDER BY DATEPART(dw, Time),DATEPART(hh, Time)) as group_num FROM [Ichilov].[dbo].[SouraskyDB] where Monitor_Alarm = 1 group by DATEADD(dd, 0, DATEDIFF(dd, 0, [Time])) ,DATEPART(dw, Time),DATENAME(dw, Time),DATEPART(hh, Time), concat(DATENAME(dw, Time),DATEPART(hh, Time)) order by  DATEPART(dw, Time),DATEPART(hh, Time)